{"version":3,"sources":["webpack:///./src/number/operators.js?7c70**"],"names":["nd","require","GradOps","Number","Operators","module","exports","window","dot","nbA","nbB","stopGrad","prefix","_dot$1d","sA","sB","nS","newShape","newValue","Float32Array","v","value","_dot$2d","pA","pB","getVolume","selector","map","d","px","indexGenerator","getSpace","aVx","bVx","vx","r","idx","c","_checkShapeThenRun","ndA","ndB","shape","space","length","Error","sA$l","slice","ret","console","log","i","leftSelect","join","_innerRet","sB$l","leftSelector","rightSelector","rightSelect","select","lpx","rpx","T","reverse","rvx","reduce","s","pow","hat","Math","warn","exp","grad","father","vjp_op","x","tanh","sigmoid","relu","validateOps","valB","vecMapping","ops","vA","vB","numMapping","isNumber","add","a","b","addOp","d1","d2","mapping","minus","minusOp","mul","mulOp","div","divOp"],"mappings":"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","file":"hot/hot-update.js","sourcesContent":["\"use strict\";\nconst nd = require('./ndarray');\nconst GradOps = require('./autograd/gradOps');\nconst Number = require('./number');\n\nconst Operators = {}\n\nif (typeof module !== 'undefined') {\n  module.exports   = Operators;\n} \nif (typeof window !== 'undefined') {\n  window.Operators = Operators;\n}\n\nOperators.dot = (nbA,nbB, stopGrad, prefix)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  const _dot$1d = (sA, sB, nS)=>{\n    let newShape = [1], newValue = new Float32Array(1);\n    for(let v = 0; v < nS; v++){\n      newValue[0] += nbA.value[v]*nbB.value[v];  \n    }\n    return Number(newValue, newShape);\n  }\n  const _dot$2d = (sA, sB, nS, pA, pB)=>{\n    let newShape = [ sA[0],sB[1] ];\n    let newValue = new Float32Array( nd.getVolume(newShape) );\n    const selector = newShape.map(d=>[0,d,1]);\n    for(let px of nd.indexGenerator(selector, nd.getSpace(newShape) ) ){\n      let aVx  = 0, bVx = 0, vx = px.vx, r = px.idx[0], c = px.idx[1];\n      for(let v = 0; v < nS; v += 1){\n        aVx = r*pA[0] + v;\n        bVx = c + v*pB[0];\n        newValue[vx] += nbA.value[aVx]*nbB.value[bVx];\n      }\n    } \n    return Number(newValue, newShape);\n  }\n  const _checkShapeThenRun = (ndA, ndB)=>{\n    const sA = nbA.shape, sB = nbB.shape;\n    const pA = nbA.space, pB = nbB.space;\n    if(sA.length==1 && sB.length==1){\n      const nS = sA[0]===sB[0]?sA[0]:null;\n      if(nS===null){ throw Error( 'shape not consitent' ) }  \n      return _dot$1d(sA, sB, nS);\n    }\n    else if(sA.length==2 && sA.length==2){\n      const nS = sA[1]===sB[0]?sA[1]:null;\n      return _dot$2d(sA, sB, nS, pA, pB);\n    }\n    else if(sA.length>2 && sB.length ==2){\n      const sA$l = sA.length;\n      const nS = sA[sA$l - 1]===sB[0]?sA[sA$l - 1]:null;\n      if(nS===null){ throw Error( 'shape not consitent' ) }  \n      let newShape = [ ...sA.slice(0,-1), sB[1] ];\n      let newValue = new Float32Array( nd.getVolume(newShape) );\n      let ret = Number(newValue, newShape);   \n      console.log('newShape', newShape);\n      let selector = sA.map((d,i)=>(i < (sA$l - 2))?[0,d,1]:d);\n      let leftSelect;\n      for(let px of nd.indexGenerator(selector, sA)){\n        leftSelect = px.idx.slice(0,-2).join(',') + ',:,:';\n        // console.warn('loop', leftSelect);\n        // console.warn(ndA.v[leftSelect]);\n        let _innerRet = Operators.dot(ndA.v[leftSelect], ndB);\n        // console.warn(_innerRet);\n        ret.v[leftSelect] = _innerRet;\n      }\n      return ret;\n    }\n    else if(sA.length>2 && sB.length >2){\n      const sA$l = sA.length, sB$l = sB.length;\n      const nS = sA[sA$l - 1]===sB[sB$l - 2]?sA[sA$l - 1]:null;\n      if(nS===null){ throw Error( 'shape not consitent' ) }  \n      let newShape = [  ...sA.slice(0,-1), \n                        ...sB.slice(0,-2), \n                        ...sB.slice(-1)   ];\n      let newValue = new Float32Array( nd.getVolume(newShape) );\n      let ret = Number(newValue, newShape);   \n      console.log('newShape', newShape);\n      let leftSelector  = sA.map((d,i)=>(i<(sA$l-2))?[0,d,1]:d);\n      let rightSelector = sB.map((d,i)=>(i<(sB$l-2))?[0,d,1]:d);\n      let leftSelect, rightSelect, select;\n      for(let lpx of nd.indexGenerator(leftSelector, sA)){\n        leftSelect = lpx.idx.slice(0,-2).join(',');\n        for(let rpx of nd.indexGenerator(rightSelector, sB)){\n          rightSelect = rpx.idx.slice(0,-2).join(',');\n          select = leftSelect +',:,' + rightSelect + ',:';\n          // console.warn('loop', leftSelect, rightSelect, select);  \n          let _innerRet = Operators.dot(ndA.v[leftSelect], \n                                      ndB.v[rightSelect]);\n          // console.warn(_innerRet);\n          ret.v[select] = _innerRet;\n        }\n      }\n      return ret;\n    }\n    else{\n      throw Error( 'shape not consitent' );\n    }\n  }\n\n  let ret = _checkShapeThenRun(nbA, nbB);\n  \n  if(stopGrad===false && GradOps.dot){\n    // console.warn('go there')\n    ret = GradOps.dot(ret, [nbA,nbB]);\n  }\n  return ret;\n};\n\n\nOperators.T = (nbA, stopGrad)=>{\n  // validateDotShape(a.shape,b.shape);\n  stopGrad = stopGrad?stopGrad:false;\n  const sA = nbA.shape, space = nbA.space;\n  let newShape = sA.slice().reverse();\n  let newValue = new Float32Array(nd.getVolume(newShape));\n  const selector = newShape.map(d=>[0,d,1]);\n  for( let px of nd.indexGenerator(selector, nd.getSpace(newShape)) ){\n    const idx = px.idx, vx = px.vx;\n    const rvx = idx.slice().reverse().reduce((s,d,i)=>s+d*space[i],0);\n    newValue[vx] = nbA.value[rvx];\n  }\n  return Number(newValue, newShape);\n};\n\nOperators.pow = (nd, hat, stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  let newValue = nd.value.map(d=>Math.pow(d,hat));\n  let ret = Number(newValue, nd.shape);\n  if(stopGrad===false && GradOps.pow){\n    ret = GradOps.pow(ret, nd, hat);\n  }\n  console.warn(ret);\n  return ret;\n}\n\nOperators.exp = (nd, stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  let newValue = nd.value.map(d=>Math.exp(d));\n  let ret      = Number(newValue, nd.shape);\n  if(nd.grad){\n    ret.grad = [{ father: nd.grad, \n      vjp_op: (x)=>Math.exp(x) }]\n  }\n  return ret;\n}\n\nOperators.tanh = (nd, stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  let newValue = nd.value.map(d=>Math.tanh(d));\n  let ret      = Number(newValue, nd.shape);\n  if(GradOps.tanh){\n    ret = GradOps.tanh(ret, nd);\n  }\n  return ret;\n}\n\nOperators.sigmoid = (nd,stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  let newValue = nd.value.map(d=>0.5*(Math.tanh(d)+1.0));\n\n  return Number(newValue, nd.shape);\n}\n\nOperators.relu = (nd,stopGrad)=>{\n  throw Error('not implement');\n};\n\nconst validateOps = (nbA, valB)=>{\n  const vecMapping = (ndA, ndB, ops)=>{\n    let vA = ndA.value, vB = ndB.value;\n    return vA.map((d,i)=>ops(vA[i], vB[i]));\n  }\n\n  const numMapping = (ndA, vB, ops)=>{\n    let vA = ndA.value;\n    return vA.map((d,i)=>ops(d,vB));\n  }\n  // console.warn(typeof nbA, typeof valB);\n  if( Number().isNumber(nbA) && typeof valB === 'number' ){\n    return numMapping;\n  }\n  if( Number().isNumber(nbA) && Number().isNumber(valB) ){\n    return vecMapping;\n  }\n  throw Error('invalide object type');\n}\n\nOperators.add = (a,b,stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  const addOp   = (d1,d2)=>d1+d2;\n  const mapping = validateOps(a,b);\n  let newValue  = mapping(a, b, addOp);\n  let ret = Number(newValue, a.shape);\n  if(stopGrad===false && GradOps.add){\n    ret = GradOps.add(ret, [a,b]);\n  }\n  return ret;\n};\n\nOperators.minus = (a,b,stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  const minusOp = (d1,d2)=>d1-d2;\n  const mapping = validateOps(a,b);\n  let newValue  = mapping(a, b, minusOp);\n  let ret = Number(newValue, a.shape);\n  if(stopGrad===false && GradOps.minus){\n    ret = GradOps.minus(ret, [a,b]);\n  }\n  return ret;\n};\n\nOperators.mul = (a,b,stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  const mulOp   = (d1,d2)=>d1*d2;\n  const mapping = validateOps(a,b);\n  let newValue  = mapping(a, b, mulOp);        \n  return Number(newValue, a.shape);  \n};\n\nOperators.div = (a,b,stopGrad)=>{\n  stopGrad = stopGrad?stopGrad:false;\n  const divOp   = (d1,d2)=>d1/d2;\n  const mapping = validateOps(a,b);\n  let newValue  = mapping(a, b, divOp);     \n  return Number(newValue, a.shape);\n};\n\n\n// WEBPACK FOOTER //\n// ./src/number/operators.js"],"sourceRoot":""}