{"version":3,"sources":["webpack:///./src/numb/ndarray.js?5da3****"],"names":["U","require","pIndex","idx","size","remapIndex","validateIndex","remapSelect","sval","shape","vsp","split","select","map","i","v","length","console","log","Number","isNaN","st","validateIndexRange","l","h","shapeSelector","get","s","sel","psel","slice","set","val","sh","_sh","Proxy","getShape","arr","Array","isArray","filter","d","getSpace","reduceRight","ss","getVolume","reduce","a","b","getVolumIndex","space","indexGenerator","selector","axis","vx","axisGenerator","axesSelector","undefined","indexOf","enummerate","generator","ravel","concat","range","c","warn","ret","ndarray","module","exports"],"mappings":"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","file":"hot/hot-update.js","sourcesContent":["\"use strict\";\nconst U = require('./ndarray_utils');\n\nconst pIndex = (idx, size) => (idx>-1)?idx:size + idx \n\nconst remapIndex = (idx,size) => {\n  U.validateIndex(idx, size);\n  return pIndex(idx, size);\n}\n\nconst remapSelect = (sval, shape)=>{\n  //numpy like selector\n  const vsp = sval.split(',');\n  const select = shape.map( (size, i)=>{\n    let v = (i<vsp.length)?vsp[i]:`0:${size}:1`;\n    console.log('v', v)\n    if( Number.isNaN(v) ) { \n      console.log( 's',  v.split(':') );\n      // let [l,h,st] = v.split(':').map(d=>{ return Number(d) });\n      st = st?st:1;\n      U.validateIndexRange(l, h, st, size);\n      return [l, h, st];\n    }\n    else { \n      return remapIndex( Number(v), size ); \n    } \n  });\n  return select;\n}\n\nconst shapeSelector = {\n    get: function(s, sel){\n        if( typeof sel !== 'symbol' && Number(sel)){\n          let psel = remapIndex( Number(sel), s.length );\n          return s.slice()[psel];  \n        }\n        else{\n          return s.slice()[sel];\n        }\n    },\n    set: function(s,sel,val){\n        sel = Number(sel) >= 0?sel:s.length + Number(sel);\n        s[sel] = val;\n        return s;\n    }\n}\n\nconst shape = (sh)=>{\n    let _sh = sh.slice();\n    return new Proxy(_sh,shapeSelector);\n}\n\nconst getShape  = (arr)=>(Array.isArray(arr))?\n  [arr.length, ...getShape(arr[0])].filter(d=>d):[null];\n\nconst getSpace = (shape)=>shape.length==0?\n\t\t1:shape.reduceRight(\n\t\t\t(ss,d,i,shape)=>(i==shape.length-1)?\n        [1]:[ ss[0]*shape[i+1],...ss],[]\n\t\t)\n\nconst getVolume = (shape)=>shape.length==0?[]:shape.reduce((a,b)=>a*b);\nconst getVolumIndex = (idx, space)=> idx.reduce((s,d,i)=>s+d*space[i],0); \n\nfunction *indexGenerator(selector, space, axis, idx){\n  axis = axis | 0;\n  idx = (idx)?idx:selector.map(()=>0);\n  const l = selector[axis][0]|selector[axis],\n        h = selector[axis][1]?selector[axis][1]:l+1,\n        s = selector[axis][2]?selector[axis][2]:1;\n  idx[axis] = l;\n  while(s>0?(idx[axis] < h):false){\n    if(axis+1<selector.length){\n      yield *indexGenerator(selector,space,axis+1,idx);\n      idx[axis] += s;\n    }\n    else{\n      yield {idx:idx,vx:idx.reduce((s,d,i)=>s+d*space[i],0)};\n      idx[axis] += s;\n    }\n  }\n}\n\nfunction *axisGenerator(axesSelector, shape, axis, idx){\n  axis = axis | 0;\n  if(idx === undefined){\n    idx = shape.map((d,i)=> (axesSelector.indexOf(i) === -1)?-1:0);\n  };\n  while( idx[axis] < shape[axis] ){\n    if( axis+1 < shape.length ){ \n      yield *axisGenerator(axesSelector,shape,axis+1,idx.slice()); \n    }\n    else{ yield idx.map(d=>d==-1?':':d); }\n    idx[axis] = idx[axis]==-1?shape[axis]:idx[axis]+1;\n  }\n}\n\nfunction *enummerate(generator){\n  let i = 0;\n  for(let v of generator){\n    yield [v, i];\n    i+=1;\n  }\n}\n\nconst ravel = (a) => a.reduce((s,a)=>{\n\t\treturn (a instanceof Array)?s.concat(ravel(a)):s.concat(a)\n\t},[]);\n\nconst range = (l, h, st)=>{\n  st = st?st:1;\n  [l, h] = h?[l,h]:[0,l];\n  for(let c = l; c < h; c += st){ \n      console.warn(c)\n      ret = [...ret, c]; }\n  return ret;\n}\n\nconst ndarray = {\n\t'getShape' : getShape,\n\t'getSpace' : getSpace,\n\t'getVolume': getVolume,\n  'getVolumIndex': getVolumIndex,\n\t'remapSelect': remapSelect,\n\t'indexGenerator': indexGenerator,\n  'axisGenerator': axisGenerator,\n\t'enummerate': enummerate,\n\t'ravel':ravel,\n  'range':range,\n  'shape':shape,\n}\nmodule.exports = ndarray;\n\n\n\n// WEBPACK FOOTER //\n// ./src/numb/ndarray.js"],"sourceRoot":""}